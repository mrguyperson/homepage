```{r}
#| name: setup

library(tidyverse)
library(readxl)
library(here)
library(glue)

source(here("functions", "functions.R"))
path <- here("cv", "publications.xlsx")
audience <- params$profile


```

```{r}
#| name: contact

contact_info <- read_excel(path, sheet = "contact")

email <- filter_and_pull(contact_info, type, "email", value)
city <- filter_and_pull(contact_info, type, "city", value)
website <- filter_and_pull(contact_info, type, "website", value)
phone <- filter_and_pull(contact_info, type, "phone", value)
```

\begingroup
\par\centering\textbf{Theodore W. Hermann, Ph.D.}
\vspace{-5pt}
\par\centering `r city` | [`r email`](mailto:`r email`) | `r phone`
\vspace{-5pt}
\par\centering Portfolio: [`r website`](`r website`)
\vspace{-5pt}

\endgroup

```{r}
#| name: summary

txt <- read_excel(path, sheet = "summary") %>%
    filter(short_audience == audience) %>%
    pull(text)

```

## Professional Summary

<!-- Data Scientist and Analyst with 7+ years’ experience transforming complex environmental and industrial data into actionable insights. Expert in building reproducible analytical pipelines and predictive models using R, Python, and SQL. Proven record of improving decision-making for scientific and engineering partners through automation, transparent reporting, and stakeholder-focused solutions. -->

`r txt`
 
``` {r}
#| name: skills

skill_data <- read_excel(path, sheet = "skills") %>%
    filter(
        as.logical(in_short_form),
        short_audience %in% c("both", audience)
        ) %>%
    group_by(short_group) %>%
    arrange(order_short, .by_group = TRUE) %>%
    ungroup()

comp <- filter_and_pull(skill_data, short_group, "core_competencies", skill) %>%
    # stringr::str_to_sentence() %>%
    paste(collapse = ", ")
stack <- filter_and_pull(skill_data, short_group, "tech_stack", skill) %>%
    paste(collapse = ", ")
```

**Core Competencies**: `r comp`

**Tech Stack**: `r stack`


## Professional Experience
\par\vspace{-5pt}
```{r}
#| name: jobs

data <- read_excel(path, sheet = "experience") %>%
    mutate(in_short_form = as.logical(in_short_form)) %>%
    filter(
        in_short_form,
        short_audience %in% c("both", audience)
        ) %>%
    mutate(
        across(start:end, mdy),
        month_start = month(start, label = TRUE, abbr = TRUE),
        end = if_else(is.na(end), today(), end),
        month_end = month(end, label = TRUE, abbr = TRUE),
        date_range = glue(
            "{month_start} {year(start)}--{month_end} {year(end)}"
        ),
        job_line = glue(
            "{date_range}: **{names_for_short}**, {organization}"
        ),
        task_list = map(tasks_for_short, ~str_split(.x, "\\*")[[1]])
    ) %>% 
    unnest(task_list) %>%
    mutate(
        bullet_tasks = glue(
            "* {task_list}"
        )
    )

jobs <- pull(data, job_line) %>% unique()

```

`r jobs[1]`

```{r}
#| results: asis

data %>%
    filter(job_line == jobs[1]) %>%
    pull(bullet_tasks)
```


`r jobs[2]`

```{r}
#| results: asis

data %>%
    filter(job_line == jobs[2]) %>%
    pull(bullet_tasks)
```


`r jobs[3]`

```{r}
#| results: asis

data %>%
    filter(job_line == jobs[3]) %>%
    pull(bullet_tasks)
```



## Education

2018\. **Ph.D.**, **Biology**. The State University of New York–College of Environmental Science and Forestry (SUNY–ESF). Syracuse, NY, USA.

2013\. **M.P.A.**, **Public Administration**. Syracuse University. Syracuse, NY, USA.

2009\. **B.S.**, **Science of Earth Systems**. Cornell University. Ithaca, NY, USA.

## Language & Work Eligibility

``` {r}
#| name: languages
languages <- filter_and_pull(skill_data, type, "language", skill) %>%
    c("Authorized to work in Germany") %>%
    paste(collapse = "\u00A0·\u00A0")


```

`r languages`